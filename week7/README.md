2025-12-01 mon


# summary 📖

## Part 3 : 코드 재작성하기

### 11장 한 번에 하나씩


한 번에 여러가지 일을 수행하는 코드는 이해하기 어렵다.
따라서 한 번에 하나의 작업만 수행하게 코드를 구성해야 한다.<br>
즉, 코드를 탈파편화*defragmenting* 하는 방법을 다룬다.

아래는 코드가 한 번에 한 가지 일만 수행하게 하는 절차이다.
1. 코드가 수행하는 모든 작업을 나열한다. 
2. 이러한 작업을 분리하여 서로 다른 함수로, 혹은 적어도 논리적으로 구분되는 영역에 놓을 수 있는 코드로 만들어라.

<br>

이번 챕터의 주요 내용은 다음과 같다.
- 작업은 작을 수 있음
    - 예) 추천/반대 의사표시 투표 도구가 한 번에 투표가 수치값으로 해석 + 점수 변경의 두 작업을 수행 → 두 작업을 순차적으로 나눠서 수행하도록 분리 → 이해하기 쉬운 코드를 만듦
- 객체에서 값 추출하기
    - 예) 모든 필드로부터 도시와 나라를 읽은 다음 포맷에 따라 연결하는 코드 <br>
    → 기본값에서 시작하여 정해진 선호도 순서로 값을 읽은 뒤 구체적인 값으로 덮어쓰기
- 더 큰 예제
    - 값이 있으면 Exit State 값 찾기-없으면 unknown 기록/HTTP 헤더가 아예 없으면 unknown 기록/값이 있으면 HTTP 응답 기록-없으면 unknown 기록/값이 있으면 Content-Type 값 기록-없으면 unknown 기록
    - 별도의 작업이 뒤섞인 위의 코드를 다음과 같이 분리할 수 있다. <br>
        읽고자 하는 각각의 값을 위한 기본값 정의(unknown) → HttpDownload에서 각각의 값 하나씩 읽기 → count[] 갱신

    → 이 코드는 함수 세 개를 별도로 만들어 개선할 수도 있다. 


### 요약
작성한 코드가 읽기 어렵다면 **수행하는 작업을 모두 나열** 후 일부를 별도의 함수나 클래스로 분리해낸다.



<br>

# insight 💡
그동안 코드를 간결하게 보이게 하려고 하나의 if문 안에 여러 기능을 몰아넣었다. 조건이 하나니까 한 블록 안에 다 넣는 게 더 깔끔할 것이라는 생각이었는데, 이번 장을 읽으면서 그 방식이 오히려 코드를 읽는 사람에게 불필요한 인지 부담을 준다는 사실을 깨달았다.

즉, 한 if문 안에 '값 읽기/상태 판단/예외 처리/데이터 가공/기록/업데이트' 등의 여러 작업이 한꺼번에 섞이면, 무슨 일이 어디서 일어나는지 파악하기 어려워진다는 걸 알게 되었다.

교재의 예시 코드도 인상적이었다.

처음 예시는 여러 작업이 뒤섞여 있어서 한 줄씩 해독해야 했고, 무엇이 핵심 로직이고 무엇이 부가 작업인지 구분하기 어려웠다.
그런데 그대로 기능을 쪼개고, `값 읽기 → 기본값/우선순위 처리 → 결과 기록`처럼 논리를 단계별로 분리해 놓은 후의 코드를 보자, 구조가 눈에 보일 정도로 명확해지고 훨씬 읽기 쉬웠다.

앞으로 코드를 작성할 때도, 이 로직이 정말 이 위치에 있어야 하는지, 이 작업을 다른 함수로 빼면 더 이해하기 쉬워질지 먼저 생각하면서 작성해야겠다는 깨달음을 얻었다.